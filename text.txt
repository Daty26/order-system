finish handler + response wrapper


Create a Kafka producer in payment-service

Make internal/kafka/producer.go.

Struct holds a sarama.SyncProducer.

NewKafkaProducer(brokers []string) (*KafkaProducer, error) creates it.

Publish(topic string, message []byte) error sends messages.
Tip: You can copy the same producer you wrote for order-service and just change the module import path.

Inject the producer

In cmd/main.go, create the producer (localhost:9092) and defer Close().

Pass it into service.NewPaymentService(...).

Use it in the service

Add a producer *kafka.KafkaProducer field to PaymentService.

In ProcessPayment, after saving to DB, json.Marshal(savedPayment) and producer.Publish("payment.completed", bytes).


